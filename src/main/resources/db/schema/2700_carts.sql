DROP TABLE IF EXISTS CARTS;

CREATE TABLE CARTS (
	ID BIGINT GENERATED BY DEFAULT AS IDENTITY
	,USER_ID BIGINT NOT NULL
	,PRODUCT_ID BIGINT
	,QUANTITY INT NOT NULL
	,PRIMARY KEY (ID)
);

ALTER TABLE CARTS
  ADD CONSTRAINT FK_CARTS_USERS_USER_ID FOREIGN KEY (USER_ID) REFERENCES USERS;

ALTER TABLE CARTS
  ADD CONSTRAINT FK_CARTS_PRODUCTS_PRODUCT_ID FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS;

ALTER TABLE CARTS
  ADD CONSTRAINT IX_CARTS_USER_ID_PRODUCT_ID
    UNIQUE (USER_ID,	PRODUCT_ID);