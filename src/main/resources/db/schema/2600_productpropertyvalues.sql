DROP TABLE IF EXISTS PRODUCT_PROPERTY_VALUES;

CREATE TABLE PRODUCT_PROPERTY_VALUES (
	ID BIGINT GENERATED BY DEFAULT AS IDENTITY
	,PRODUCT_ID BIGINT NOT NULL
	,PROPERTY_VALUE_ID BIGINT
	,PRIMARY KEY (ID)
);

ALTER TABLE PRODUCT_PROPERTY_VALUES
  ADD CONSTRAINT FK_PRODUCT_PROPERTY_VALUES_PRODUCTS_PRODUCT_ID
  FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS;

ALTER TABLE PRODUCT_PROPERTY_VALUES
  ADD CONSTRAINT FK_PRODUCT_PROPERTY_VALUES_PROPERTY_VALUES_PROPERTY_VALUE_ID
  FOREIGN KEY (PROPERTY_VALUE_ID) REFERENCES PROPERTY_VALUES;

ALTER TABLE PRODUCT_PROPERTY_VALUES
  ADD CONSTRAINT IX_PRODUCT_PROPERTY_VALUES_PRODUCT_ID_PROPERTY_VALUE_ID
  UNIQUE (PRODUCT_ID, PROPERTY_VALUE_ID);
